<ul class="access-item-wrapper">
  <% tree.each do |facility_group, fg_info| %>
    <li>
      <div class="access-item collapsed">
        <% initial_tree_depth.times do %>
          <span class="spacer"></span>
        <% end %>

        <%= access_checkbox(
                form,
                :facility_groups,
                facility_group,
                page: page,
                checked: page.eql?(:edit) && user_being_edited.facility_group_tree.dig(facility_group, :full_access)
            ) %>

        <span class="access-ratio collapsed">
          <i class="fas fa-angle-down light"></i>
          <%= access_fraction("facility", fg_info[:accessible_facility_count], 0) %>
        </span>
      </div>

      <%= render "email_authentications/invitations/facility_access_tree",
          tree: fg_info[:facilities],
          page: page,
          form: form,
          user_being_edited: user_being_edited,
          initial_tree_depth: initial_tree_depth + 1 %>
    </li>
  <% end %>
</ul>
